# データスキーマガイド

このガイドでは、`questions.csv`、`answers.csv`、`law_revision.csv` に取り込める列の意味と必須 / 任意区分、想定データ型、入力例をまとめています。テンプレートを編集するときや既存データを整形するときのリファレンスとして活用してください。

## 共通の注意事項

- 文字列列の前後の空白は自動的に除去されます。
- `tags` 列はセミコロン (`;`) 区切りで複数タグを指定できます。
- `difficulty` は 1〜5 の整数を想定しており、省略時は 3 が自動で補われます。
- `id` 列を指定した場合はその値が優先され、未指定の場合はアプリ側で安定した ID を自動生成します。

## `questions.csv`

| 列名 | 型 | 必須 | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `id` | 文字列 | 任意 | 既存データとの突合に利用する識別子。未指定の場合は `year`, `q_no`, `question` 等から自動生成されます。 | `2024-01-rights` |
| `year` | 整数 | 必須 | 出題年度。数値以外を入力した場合はエラーになります。 | `2024` |
| `q_no` | 整数 | 必須 | 年度内の問番号。整数で入力してください。 | `12` |
| `category` | 文字列 | 任意 | 分野名。未入力の場合は「宅建業法」が自動で補われます。テンプレートにある 4 分野（宅建業法 / 権利関係 / 法令上の制限 / 税・その他）に正規化されます。 | `権利関係` |
| `topic` | 文字列 | 任意 | 分野内の小分類や論点メモ。 | `民法/共有` |
| `question` | 文字列 | 必須 | 問題本文。空欄はエラーになります。 | `共有物の管理に関する次の記述のうち...` |
| `choice1` | 文字列 | 必須 | 選択肢 A に対応する文。4択すべての選択肢に値が必要です。 | `管理行為は持分の過半数で決する。` |
| `choice2` | 文字列 | 必須 | 選択肢 B。 | `各共有者は常に単独で保存行為をできる。` |
| `choice3` | 文字列 | 必須 | 選択肢 C。 | `賃貸借契約の更新は変更行為である。` |
| `choice4` | 文字列 | 必須 | 選択肢 D。 | `共有物の形状を変更する行為は管理行為である。` |
| `explanation` | 文字列 | 任意 | 問題の解説。`answers.csv` の内容で上書きする設定も可能です。 | `管理行為は持分過半数...` |
| `difficulty` | 整数 | 任意 | 1（易しい）〜5（難しい）の難易度。空欄は 3 に正規化されます。 | `3` |
| `tags` | 文字列 | 任意 | 学習用のタグ。セミコロン区切りで複数指定可能。 | `R6;民法;共有` |

## `answers.csv`

| 列名 | 型 | 必須 | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `year` | 整数 | 必須 | 対応する問題の出題年度。 | `2024` |
| `q_no` | 整数 | 必須 | 対応する問題の問番号。 | `12` |
| `correct_number` | 整数 | 必須 | 正答番号。1〜4 のいずれか。空欄や範囲外はエラーになります。 | `3` |
| `correct_label` | 文字列 | 任意 | 正答を A〜D で指定する代替列。`correct_number` が優先され、未入力時の補完に利用されます。 | `C` |
| `correct_text` | 文字列 | 任意 | 正答となる選択肢文をそのまま記載。上記 2 列が空欄の場合のフォールバックとして使用されます（部分一致も自動判定）。 | `管理行為は持分過半数で決する。` |
| `explanation` | 文字列 | 任意 | 正答に関する解説。マージ時のポリシー設定に応じて `questions.csv` の解説を上書きできます。 | `賃貸借契約は管理行為に該当...` |
| `difficulty` | 整数 | 任意 | 問題の難易度。入力があれば `questions.csv` の値を上書きできます。 | `3` |
| `tags` | 文字列 | 任意 | 正答データに紐づくタグ。マージ設定により問題タグと結合または上書きできます。 | `正解;頻出` |

## `law_revision.csv`

| 列名 | 型 | 必須 | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `id` | 文字列 | 任意 | データを一意に識別する ID。未指定の場合は法令名・改正年・問題文から自動生成されます。 | `lawrev-2024-01` |
| `label` | 文字列 | 任意 | 問題を識別しやすい短いラベル。 | `2024年改正ポイント01` |
| `law_name` | 文字列 | 必須 | 法改正の対象となる法令名。空欄はエラーになります。 | `宅建業法` |
| `revision_year` | 整数 | 任意 | 改正が公布された西暦年。数値以外は拒否されます。 | `2024` |
| `effective_date` | 文字列 | 任意 | 施行日や適用開始日。自由形式ですが `YYYY-MM-DD` が推奨です。 | `2024-04-01` |
| `category` | 文字列 | 任意 | 分野名。`questions.csv` と同様に既定の 4 分野に正規化されます。 | `宅建業法` |
| `topic` | 文字列 | 任意 | 法改正の論点やトピック。 | `重要事項説明` |
| `source` | 文字列 | 任意 | 情報ソース（告示名やテキストなど）。 | `国交省告示第○号` |
| `question` | 文字列 | 必須 | 法改正に関する設問本文。 | `2024年改正によって新たに義務付けられた事項はどれか。` |
| `choice1` | 文字列 | 必須 | 選択肢 A。 | `重要事項説明書に改正内容を追記する義務` |
| `choice2` | 文字列 | 必須 | 選択肢 B。 | `改正前後で重要事項説明は不要になる` |
| `choice3` | 文字列 | 必須 | 選択肢 C。 | `免許更新手続が不要になる` |
| `choice4` | 文字列 | 必須 | 選択肢 D。 | `宅建士証の携帯義務が撤廃される` |
| `correct` | 整数 | 任意 | 正答番号。1〜4 のいずれか。空欄時は未設定として扱われます。 | `1` |
| `explanation` | 文字列 | 任意 | 法改正ポイントの補足説明。 | `義務化された事項の概要と根拠条文を記載。` |
| `difficulty` | 整数 | 任意 | 難易度。未入力時は 3 が設定されます。 | `3` |
| `tags` | 文字列 | 任意 | タグ。セミコロン区切りで複数指定可能。 | `法改正;直前対策` |

---

必要な列が欠けている場合や値が規定の範囲外にある場合、インポート画面で詳細なエラーメッセージが表示されます。疑問点があればテンプレート ZIP に同梱されるこのドキュメントを参照しながらデータを整形してください。
